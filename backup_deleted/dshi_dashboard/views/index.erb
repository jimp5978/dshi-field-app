<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSHI Ï°∞Î¶ΩÌíà ÎåÄÏãúÎ≥¥Îìú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            text-decoration: none;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .dashboard-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e1e5e9;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }
        
        /* Ï†ÑÏ≤¥ ÌòÑÌô© */
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-card {
            background: #f8f9fc;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #667eea;
        }
        
        .stat-number {
            font-size: 28px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        /* Í≥µÏ†ï ÏôÑÎ£åÏú® */
        .process-list {
            space-y: 15px;
        }
        
        .process-item {
            margin-bottom: 15px;
        }
        
        .process-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .process-name {
            font-weight: 600;
            color: #333;
        }
        
        .process-percentage {
            font-weight: 600;
            color: #667eea;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        /* ÏÉÅÌÉúÎ≥Ñ Î∂ÑÌè¨ */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .status-item {
            background: #f8f9fc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .status-count {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .status-complete { color: #28a745; }
        .status-progress { color: #007bff; }
        .status-waiting { color: #ffc107; }
        .status-delayed { color: #dc3545; }
        
        /* ÏõîÎ≥Ñ ÏßÑÌñâÎ•† */
        .monthly-progress {
            text-align: center;
        }
        
        .progress-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0deg <%= (@data['monthly_progress']['percentage'] * 3.6).round %>deg, #e1e5e9 <%= (@data['monthly_progress']['percentage'] * 3.6).round %>deg 360deg);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .progress-circle::before {
            content: '';
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            position: absolute;
        }
        
        .progress-text {
            position: relative;
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }
        
        .progress-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .progress-detail {
            text-align: center;
        }
        
        .progress-detail-number {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }
        
        .progress-detail-label {
            font-size: 12px;
            color: #666;
        }
        
        /* ÏóÖÏ≤¥Î≥Ñ ÎπÑÏú® */
        .company-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .company-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fc;
            border-radius: 8px;
        }
        
        .company-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .company-percentage {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
        }
        
        /* Ïù¥Ïäà Ï∂îÏ†Å */
        .issues-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .issue-item {
            padding: 15px;
            border-left: 4px solid;
            margin-bottom: 15px;
            background: #f8f9fc;
            border-radius: 0 8px 8px 0;
        }
        
        .issue-high { border-left-color: #dc3545; }
        .issue-medium { border-left-color: #ffc107; }
        .issue-low { border-left-color: #28a745; }
        
        .issue-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }
        
        .issue-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .issue-time {
            font-size: 12px;
            color: #999;
        }
        
        .last-updated {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e1e5e9;
        }
        
        .refresh-info {
            color: #666;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .overview-stats,
            .status-grid,
            .company-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>üè≠ DSHI Ï°∞Î¶ΩÌíà ÏßÑÌñâ ÌòÑÌô© ÎåÄÏãúÎ≥¥Îìú</h1>
            <div class="user-info">
                <span>ÌôòÏòÅÌï©ÎãàÎã§, <%= @user['username'] %>Îãò (Level <%= @user['level'] %>)</span>
                <a href="/logout" class="logout-btn">Î°úÍ∑∏ÏïÑÏõÉ</a>
            </div>
        </div>
    </header>

    <div class="dashboard-container">
        <!-- Ï≤´ Î≤àÏß∏ Ï§Ñ: Ï†ÑÏ≤¥ ÌòÑÌô© & Í≥µÏ†ï ÏôÑÎ£åÏú® -->
        <div class="dashboard-grid">
            <div class="dashboard-section">
                <h2 class="section-title">üìä Ï†ÑÏ≤¥ ÌòÑÌô©</h2>
                <div class="overview-stats">
                    <div class="stat-card">
                        <div class="stat-number"><%= @data['total_assemblies'] %></div>
                        <div class="stat-label">Ï¥ù Ï°∞Î¶ΩÌíà</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number"><%= @data['monthly_progress']['percentage'].round(1) %>%</div>
                        <div class="stat-label">Ï†ÑÏ≤¥ ÏßÑÌñâÎ•†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number"><%= @data['monthly_progress']['completed'] %></div>
                        <div class="stat-label">ÏôÑÎ£åÎêú Ï°∞Î¶ΩÌíà</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number"><%= @data['monthly_progress']['remaining'] %></div>
                        <div class="stat-label">ÏûîÏó¨ Ï°∞Î¶ΩÌíà</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-section">
                <h2 class="section-title">üîß 7Îã®Í≥Ñ Í≥µÏ†ï ÏôÑÎ£åÏú®</h2>
                <div class="process-list">
                    <% @data['process_completion'].each do |process, percentage| %>
                        <div class="process-item">
                            <div class="process-header">
                                <span class="process-name"><%= process %></span>
                                <span class="process-percentage"><%= percentage.round(1) %>%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: <%= percentage %>%"></div>
                            </div>
                        </div>
                    <% end %>
                </div>
            </div>
        </div>

        <!-- Îëê Î≤àÏß∏ Ï§Ñ: ÏÉÅÌÉúÎ≥Ñ Î∂ÑÌè¨ & ÏõîÎ≥Ñ ÏßÑÌñâÎ•† -->
        <div class="dashboard-grid">
            <div class="dashboard-section">
                <h2 class="section-title">üìà ÏÉÅÌÉúÎ≥Ñ Î∂ÑÌè¨</h2>
                <div class="status-grid">
                    <% 
                       status_classes = {
                         'ÏôÑÎ£å' => 'status-complete',
                         'ÏßÑÌñâÏ§ë' => 'status-progress', 
                         'ÎåÄÍ∏∞' => 'status-waiting',
                         'ÏßÄÏó∞' => 'status-delayed'
                       }
                    %>
                    <% @data['status_distribution'].each do |status, count| %>
                        <div class="status-item">
                            <div class="status-count <%= status_classes[status] %>"><%= count %></div>
                            <div class="stat-label"><%= status %></div>
                        </div>
                    <% end %>
                </div>
            </div>

            <div class="dashboard-section">
                <h2 class="section-title">üìÖ ÏõîÎ≥Ñ ÏßÑÌñâÎ•†</h2>
                <div class="monthly-progress">
                    <div class="progress-circle">
                        <div class="progress-text"><%= @data['monthly_progress']['percentage'].round(1) %>%</div>
                    </div>
                    <div class="progress-details">
                        <div class="progress-detail">
                            <div class="progress-detail-number"><%= @data['monthly_progress']['planned'] %></div>
                            <div class="progress-detail-label">Í≥ÑÌöç</div>
                        </div>
                        <div class="progress-detail">
                            <div class="progress-detail-number"><%= @data['monthly_progress']['completed'] %></div>
                            <div class="progress-detail-label">ÏôÑÎ£å</div>
                        </div>
                        <div class="progress-detail">
                            <div class="progress-detail-number"><%= @data['monthly_progress']['remaining'] %></div>
                            <div class="progress-detail-label">ÏûîÏó¨</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏÑ∏ Î≤àÏß∏ Ï§Ñ: ÏóÖÏ≤¥Î≥Ñ ÎπÑÏú® & Ïù¥Ïäà Ï∂îÏ†Å -->
        <div class="dashboard-grid">
            <div class="dashboard-section">
                <h2 class="section-title">üè¢ ÏóÖÏ≤¥Î≥Ñ ÎπÑÏú®</h2>
                <div class="company-stats">
                    <div class="company-item">
                        <div class="company-name">ÏÇ¨ÎÇ¥ÏóÖÏ≤¥</div>
                        <div class="company-percentage">68%</div>
                    </div>
                    <div class="company-item">
                        <div class="company-name">Ïô∏Î∂ÄÏóÖÏ≤¥</div>
                        <div class="company-percentage">32%</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-section">
                <h2 class="section-title">‚ö†Ô∏è Ïù¥Ïäà Ï∂îÏ†Å</h2>
                <div class="issues-list">
                    <% @data['issues'].each do |issue| %>
                        <div class="issue-item issue-<%= issue['priority'] %>">
                            <div class="issue-title"><%= issue['title'] %></div>
                            <div class="issue-description"><%= issue['description'] %></div>
                            <div class="issue-time">üìÖ <%= issue['time'] %></div>
                        </div>
                    <% end %>
                </div>
            </div>
        </div>

        <div class="last-updated">
            <div class="refresh-info">
                üïê ÎßàÏßÄÎßâ ÏóÖÎç∞Ïù¥Ìä∏: <%= Time.now.strftime("%Y-%m-%d %H:%M:%S") %> | 
                ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ®: 5Î∂ÑÎßàÎã§ | 
                Îç∞Ïù¥ÌÑ∞ ÏÜåÏä§: <%= @data['source'] || 'Mock Data' %>
            </div>
        </div>
    </div>

    <script>
        // 5Î∂ÑÎßàÎã§ ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ®
        setTimeout(function() {
            window.location.reload();
        }, 300000); // 5Î∂Ñ = 300,000ms
        
        // Ïã§ÏãúÍ∞Ñ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR');
            // ÏãúÍ∞Ñ ÌëúÏãú ÏöîÏÜåÍ∞Ä ÏûàÎã§Î©¥ ÏóÖÎç∞Ïù¥Ìä∏
        }
        
        setInterval(updateTime, 1000);
    </script>
</body>
</html>